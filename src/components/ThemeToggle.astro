---
const id = 'theme-toggle';
---
<button id={id} class="inline-flex items-center gap-2 rounded-lg border border-neutral-300/50 bg-neutral-100/50 backdrop-blur-sm px-4 py-2 text-sm hover:bg-neutral-200/50 hover:border-brand-500/50 hover:scale-105 transition-all duration-300 dark:border-neutral-700/50 dark:bg-neutral-800/50 dark:hover:bg-neutral-700/50" aria-label="Toggle theme">
  <svg id="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-4 w-4 hidden"><path fill="currentColor" d="M12 18a6 6 0 1 0 0-12a6 6 0 0 0 0 12m0 4a1 1 0 0 1-1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1m-7-5a1 1 0 0 1-.707-1.707l.707-.707a1 1 0 1 1 1.414 1.414l-.707.707A1 1 0 0 1 5 17M3 13a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2zm8-9a1 1 0 0 1 1-1v1a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1m7 5a1 1 0 0 1 .707 1.707l-.707.707a1 1 0 1 1-1.414-1.414l.707-.707A1 1 0 0 1 18 7m2 6a1 1 0 1 1 0 2h-1a1 1 0 1 1 0-2zm-3 4.95a1 1 0 1 1-1.414 1.414l-.707-.707A1 1 0 0 1 15 17z"/></svg>
  <svg id="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-4 w-4"><path fill="currentColor" d="M11.646 2.014a1 1 0 0 1 .977.216A10 10 0 1 0 21.77 2.623a1 1 0 0 1 1.595 1.163A12 12 0 1 1 10.86.942a1 1 0 0 1 .786 1.072z"/></svg>
  <span>主题</span>
</button>
<script>
  const root = document.documentElement;
  const btn = document.getElementById('theme-toggle');
  const iconSun = document.getElementById('icon-sun');
  const iconMoon = document.getElementById('icon-moon');
  const storageKey = 'theme';
  const apply = (mode) => {
    if (mode === 'light') {
      root.classList.remove('dark');
      iconSun?.classList.add('hidden');
      iconMoon?.classList.remove('hidden');
    } else {
      root.classList.add('dark');
      iconSun?.classList.remove('hidden');
      iconMoon?.classList.add('hidden');
    }
  };
  const pref = localStorage.getItem(storageKey) || 'dark';
  apply(pref);
  btn?.addEventListener('click', () => {
    const next = root.classList.contains('dark') ? 'light' : 'dark';
    localStorage.setItem(storageKey, next);
    apply(next);
  });
</script>

